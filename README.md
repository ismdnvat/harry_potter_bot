
# Инструкция к боту "Анкета Гарри Поттера"

## Описание
Бот "Анкета Гарри Поттера" позволяет пользователям создать и управлять своим профилем в стиле мира Гарри Поттера. Пользователи могут настраивать свои данные, включая имя, факультет, курс, роль в Квиддиче и оценки по различным предметам. Бот использует библиотеку Aiogram для взаимодействия с Telegram API и SQLite для хранения данных пользователей.

## Требования
- Python 3.7+
- Библиотеки:
  - aiogram
  - sqlite3

## Установка
1. Клонируйте репозиторий или скачайте исходный код.
2. Установите необходимые зависимости:
    ```sh
    pip install aiogram
    ```
3. Создайте файл базы данных `harry_potter.db` и выполните необходимые миграции (бот автоматически создаст таблицы при первом запуске).
4. Установите свой API токен в переменной `API_TOKEN`.

## Структура проекта
- **main.py**: основной файл для запуска бота.
- **db.py**: файл для работы с базой данных.
- **handlers.py**: файл с хэндлерами для обработки сообщений и команд.
- **states.py**: файл с состояниями для машины состояний.
- **img/**: директория для хранения изображений факультетов.

## Основные компоненты

### Состояния
Файл: `states.py`

- `QuizStates`: состояния для викторины.
  - `CHOOSING_PART`: выбор части викторины.
  - `CHOOSING_LEVEL`: выбор уровня сложности.
  - `TAKING_QUIZ`: прохождение викторины.

- `ProfileStates`: состояния для настройки профиля.
  - `SETTING_PROFILE`: настройка профиля.
  - `SETTING_NAME`: ввод имени.
  - `SETTING_FACULTY`: распределение по факультету.
  - `SETTING_YEAR`: выбор курса.
  - `SETTING_QUIDDITCH_ROLE`: выбор роли в Квиддиче.
  - `CHOOSING_SUBJECT`: выбор предмета для оценки.
  - `SETTING_GRADE`: установка оценки.
  - `EDITING_PROFILE`: редактирование профиля.
  - `DELETING_PROFILE`: удаление профиля.
  - `EDIT_NAME`: редактирование имени.
  - `EDIT_FACULTY`: редактирование факультета.
  - `EDIT_YEAR`: редактирование курса.
  - `EDIT_QUIDDITCH_ROLE`: редактирование роли в Квиддиче.

### Обработчики
Файл: `handlers.py`

- **Команды:**
  - `/start`: приветствие и выбор действий.
  - `Настроить профиль`: запуск процесса настройки профиля.
  - `Редактировать профиль`: запуск процесса редактирования профиля.
  - `Удалить профиль`: удаление профиля.
  - `Просмотреть информацию о себе`: просмотр информации о профиле.

- **Callback handlers:**
  - Настройка и редактирование профиля через InlineKeyboardMarkup.
  - Установка и редактирование имени, факультета, курса, роли в Квиддиче и оценок.

### База данных
Файл: `db.py`

- Таблица `users` для хранения информации о пользователях.
  - Поля: `user_id`, `name`, `faculty`, `year`, `quidditch_role`, `astronomy`, `charms`, `dada`, `potions`, `history_of_magic`, `herbology`, `transfiguration`, `flying`.
- Функции для добавления колонок в таблицу, если они отсутствуют.

## Примеры использования

- **/start**: запускает бота и приветствует пользователя.
- **Настроить профиль**: запускает процесс настройки профиля, пользователь может установить имя, факультет, курс, роль в Квиддиче и оценки.
- **Редактировать профиль**: позволяет редактировать существующие данные профиля.
- **Удалить профиль**: удаляет профиль пользователя из базы данных.
- **Просмотреть информацию о себе**: показывает текущую информацию о профиле пользователя.

## Запуск
Для запуска бота выполните команду:
```sh
python main.py
```
Бот начнет работу и будет ожидать команд от пользователей.

## Запуск с помощью Docker

### Требования
- Docker
- Docker Compose

1. Замените `YOUR_API_TOKEN` на ваш API токен. файла docker-compose.yml` 
2. Соберите и запустите контейнеры:

    ```sh
    docker-compose up --build
    ```
Бот будет запущен и доступен для взаимодействия в Telegram.

## Заключение
Бот "Анкета Гарри Поттер" предоставляет интерактивный интерфейс для создания и управления профилем в стиле мира Гарри Поттера, делая процесс интересным и увлекательным для пользователей.
